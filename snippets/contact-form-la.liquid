{{ 'section-contact-form.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
  
  /* Button Show/Hide Styles */
  .show_form_button {
    text-align: center;
    margin: 20px 0;
  }
  
  .show_form_button.hidden {
    display: none;
  }
  
  .button_custom_contact {
    background-color: #116885 !important;
    padding: 13px 40px !important;
    width: fit-content !important;
    color: #fff !important;
    font-size: 16px !important;
    font-weight: 700 !important;
    line-height: 125% !important;
    letter-spacing: .16px !important;
    text-transform: uppercase !important;
    border: none;
    cursor: pointer;
    border-radius: 4px;
  }
  
  /* Form Container Styles */
  .contact_form_container {
    display: none;
    opacity: 0;
    transition: opacity 0.4s ease;
  }
  
  .contact_form_container.show {
    display: block;
    opacity: 1;
  }
  
  /* Phone Field Show/Hide */
  #ContactForm-phone-wrapper {
    /* display: none;
    opacity: 0;
    transition: opacity 0.3s ease; */
  }
  
  #ContactForm-phone-wrapper.show {
    /* display: block;
    opacity: 1; */
  }
  
  /* Form Styles */
  #customer-form {
    /* max-width: 500px; */
    margin: 20px auto;
    padding: 20px;
  }
  
  .form-group {
    margin-bottom: 15px;
  }
  
  .form-group input,
  .form-group textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    box-sizing: border-box;
    background: white !important;
    color: black !important;
  }
  
  .label_custom {
    position: absolute;
    left: 11px;
    top: 12px;
    color: darkgray;
    background: white;
    width: 96px;
    pointer-events: none;
  }
  
  .form-group_custom {
    position: relative;
  }
  
  .textbox-n:focus + .label_custom {
    display: none;
  }
  
  .notes {
    padding: 12px;
    margin: 15px 0;
    border-radius: 4px;
    display: none;
    text-align: center;
  }
  
  .note--success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }
  
  .note--error {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
  }
  
  #customer-form button[type="submit"] {
    width: 100%;
    padding: 12px;
    background: #000;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
  }
  
  #customer-form button[type="submit"]:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
{%- endstyle -%}

<div class="color-{{ section.settings.color_scheme }} gradient">
  <div class="contact page-width section-{{ section.id }}-padding">
    
    {%- if section.settings.heading != blank -%}
      <h2 class="title title-wrapper--no-top-margin inline-richtext {{ section.settings.heading_size }}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
        {{ section.settings.heading }}
      </h2>
    {% endif %}
    
    <!-- Show Form Button -->
    <div class="show_form_button" id="showFormButton">
      <button type="button" class="button_custom_contact" onclick="showContactForm()">
        {{ section.settings.button_text | default: "Be the first to know when it drops" }}
      </button>
    </div>
    
    <!-- Contact Form Container (Hidden by default) -->
    <div class="contact_form_container" id="contactFormContainer">
      <form name="google-sheet" id="customer-form">
        
        <div class="form-group">
          <input type="email" id="ContactForm-email" name="email" placeholder="Email Address *" required>
        </div>

        <div class="form-group" id="ContactForm-phone-wrapper">
          <input type="tel" name="phone" placeholder="Phone Number">
        </div>
        
        <button type="submit" class="button">Submit</button>
        
    
      </form>
    </div>
    
  </div>
</div>

<script>
  // Show/Hide Form Function
  function showContactForm() {
    const formContainer = document.getElementById('contactFormContainer');
    const showButton = document.getElementById('showFormButton');
    
    showButton.classList.add('hidden');
    formContainer.classList.add('show');
  }
  
  // Show phone field when email is entered
  document.addEventListener('DOMContentLoaded', function() {
    const emailInput = document.getElementById('ContactForm-email');
    const phoneWrapper = document.getElementById('ContactForm-phone-wrapper');
    
    if (emailInput && phoneWrapper) {
      // Check if email already has value (on page load)
      if (emailInput.value.trim() !== '') {
        phoneWrapper.classList.add('show');
      }
      
      // Show phone field when user starts typing email
      emailInput.addEventListener('input', function() {
        if (this.value.trim() !== '') {
         // phoneWrapper.classList.add('show');
        } else {
          // phoneWrapper.classList.remove('show');
        }
      });
    }
  });
  
  // Google Sheet Form Submission
  (function() {
    'use strict';
    
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyYnp7ADNeUEa0uymbMjrH6UhJ1yv53GC_iDEN_hcbhdR1XCO_-xptIUdWCk9ulOK7L/exec';
    
    const form = document.getElementById('customer-form');
    const submitBtn = form.querySelector('button[type="submit"]');

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Submitting...';
      submitBtn.disabled = true;
      
      const formData = new FormData(form);
          
      fetch(scriptURL, { 
        method: 'POST',
        body: formData
      })
      .then(function(response) {
        return response.text();
      })
      .then(function(responseText) {
        try {
          const data = JSON.parse(responseText);
          
          if (data.result === 'success') {
            form.reset();
            
            // Hide phone field after reset
            const phoneWrapper = document.getElementById('ContactForm-phone-wrapper');
            if (phoneWrapper) {
              phoneWrapper.classList.remove('show');
            }
            
           
          } else {
            throw new Error(data.error || 'Unknown error');
          }
        } catch (parseError) {
        
        }
      })
      .catch(function(error) {
      
      })
      .finally(function() {
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      });
    });
  })();
</script>